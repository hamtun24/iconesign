(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5629:function(e,t,s){Promise.resolve().then(s.bind(s,1379))},1379:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return B}});var a=s(7437),r=s(2265),i=s(5251),l=s(6637),n=s(2369),c=s(2851),o=s(7810),d=s(1827),m=s(2167),x=s(1541),u=s(4900),h=s(5817),g=s(3067),p=s(3008),f=s(5020),b=s(1981),j=s(2549),v=s(4660),y=s(4810);let N=(0,v.Ue)()((0,y.mW)((e,t)=>({files:[],credentials:null,certificateInfo:null,isProcessing:!1,results:null,currentStage:"Pr\xeat",overallProgress:0,sessionId:null,addFiles:t=>{let s=t.map(e=>({id:crypto.randomUUID(),file:e,status:"pending",progress:0,stage:"upload"}));e(e=>({files:[...e.files,...s]}))},removeFile:t=>{e(e=>({files:e.files.filter(e=>e.id!==t)}))},clearFiles:()=>{e({files:[]})},setCredentials:t=>{e({credentials:t})},fetchCertificateInfo:async()=>{try{let t=await fetch("".concat("https://itchy-cars-march.loca.lt/api/v1","/certificates/info"));if(!t.ok)throw Error("Failed to fetch certificate info: ".concat(t.status));let s=await t.json();e({certificateInfo:s})}catch(t){console.error("Failed to fetch certificate info:",t),e({certificateInfo:{defaultPath:"classpath:certificates/icone.crt",availableCertificates:[],supportedFormats:[".crt",".pem",".cer"],instructions:["Placez votre fichier de certificat dans src/main/resources/certificates/","Le certificat par d\xe9faut doit \xeatre nomm\xe9 icone.crt"]}})}},refreshProgress:async()=>{let{isProcessing:s,sessionId:a}=t();if(s&&a)try{let t=localStorage.getItem("auth_token"),s=await fetch("".concat("https://itchy-cars-march.loca.lt/api/v1","/progress/").concat(a),{headers:{Authorization:"Bearer ".concat(t)}});if(!s.ok){console.warn("Failed to fetch progress:",s.status);return}let r=await s.json();console.log("Progress data received:",r),e(e=>{let t=e.files.map(e=>{var t,s;let a=null===(t=r.files)||void 0===t?void 0:t.find(t=>t.filename===e.file.name);if(a){let t="COMPLETED"===a.status?"completed":"FAILED"===a.status?"error":"PROCESSING"===a.status?"processing":"pending",r=(null===(s=a.stage)||void 0===s?void 0:s.toLowerCase())||"sign",i={...e,status:t,stage:r,progress:a.progress||0,error:a.errorMessage,ttnInvoiceId:a.ttnInvoiceId};return console.log("Updated file ".concat(e.file.name,":"),i),i}return e}),s=t.reduce((e,t)=>e+t.progress,0),a=t.length>0?s/t.length:0,i=t.reduce((e,t)=>{let s=["sign","save","validate","transform","package"],a=s.indexOf(e);return s.indexOf(t.stage)>a?t.stage:e},"sign");if("COMPLETED"===r.status||"FAILED"===r.status){let e={success:"COMPLETED"===r.status,totalFiles:t.length,successfulFiles:t.filter(e=>"completed"===e.status).length,failedFiles:t.filter(e=>"error"===e.status).length,zipDownloadUrl:r.zipDownloadUrl,message:r.message||"Traitement termin\xe9",files:t};return{files:t,overallProgress:100,currentStage:"COMPLETED"===r.status?"Traitement termin\xe9 avec succ\xe8s":"Traitement termin\xe9 avec erreurs",isProcessing:!1,results:e}}return{files:t,overallProgress:Math.round(a),currentStage:r.message||"\xc9tape ".concat(i.toUpperCase()," en cours...")}})}catch(e){console.error("Failed to refresh progress:",e)}},startProcessing:async()=>{let{files:s}=t();if(0!==s.length){e({isProcessing:!0,currentStage:"Pr\xe9paration des fichiers..."}),e(e=>({files:e.files.map(e=>({...e,status:"processing",stage:"sign",progress:10}))}));try{let t=new FormData;s.forEach(e=>{let{file:s}=e;t.append("files",s)}),e({currentStage:"Traitement des fichiers via le workflow unifi\xe9 IconeSign..."});let a=localStorage.getItem("auth_token"),r=await fetch("".concat("https://itchy-cars-march.loca.lt/api/v1","/workflow/process-invoices"),{method:"POST",headers:{Authorization:"Bearer ".concat(a)},body:t});if(!r.ok)throw Error("HTTP ".concat(r.status,": ").concat(r.statusText));let i=await r.json(),l=i.sessionId;l?(e({sessionId:l}),console.log("Session ID received:",l),e(e=>({files:e.files.map(e=>({...e,status:"processing",stage:"sign",progress:5}))}))):(console.error("No session ID received:",i),e({isProcessing:!1,currentStage:"Erreur: "+(i.message||"Pas de session ID re\xe7u")}))}catch(a){console.error("\xc9chec du traitement du workflow:",a);let t=s.map(e=>({...e,status:"error",error:a instanceof Error?a.message:"Erreur inconnue"}));e({files:t,isProcessing:!1,currentStage:"Erreur survenue",results:{success:!1,totalFiles:s.length,successfulFiles:0,failedFiles:s.length,message:a instanceof Error?a.message:"\xc9chec du traitement",files:t}})}}},updateFileProgress:(t,s,a)=>{e(e=>({files:e.files.map(e=>e.id===t?{...e,progress:s,stage:a,status:"processing"}:e)}))},setResults:t=>{e({results:t})},reset:()=>{e({files:[],credentials:null,isProcessing:!1,results:null,currentStage:"Pr\xeat",overallProgress:0,sessionId:null})}}),{name:"workflow-store"}));var w=s(1424);function E(e){let{onNext:t}=e,{files:s,addFiles:n,removeFile:c}=N(),[o,d]=(0,r.useState)(!1),u=(0,r.useCallback)((e,t)=>{t.length>0&&t.forEach(e=>{let{file:t,errors:s}=e;s.forEach(e=>{w.Am.error("".concat(t.name,": ").concat(e.message))})}),e.length>0&&(n(e),w.Am.success("".concat(e.length," fichier(s) ajout\xe9(s)")))},[n]),{getRootProps:h,getInputProps:g,isDragActive:v}=(0,f.uI)({onDrop:u,accept:{"text/xml":[".xml"],"application/xml":[".xml"]},maxSize:16777216,multiple:!0,onDragEnter:()=>d(!0),onDragLeave:()=>d(!1)}),y=e=>{if(0===e)return"0 Octets";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Octets","Ko","Mo","Go"][t]};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h2",{className:"text-2xl font-display font-bold text-gray-800 mb-2",children:"T\xe9l\xe9chargez vos Factures XML"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Glissez-d\xe9posez vos fichiers XML ici, ou cliquez pour parcourir"})]}),(0,a.jsxs)("div",{...h(),className:"\n          file-upload-zone cursor-pointer\n          ".concat(v||o?"dragover":"","\n        "),children:[(0,a.jsx)("input",{...g()}),(0,a.jsxs)(i.E.div,{whileHover:{scale:1.02},whileTap:{scale:.98},animate:{y:v?-10:0,scale:v?1.1:1},className:"flex flex-col items-center gap-4",children:[(0,a.jsx)("div",{className:"p-4 bg-adorable-blue/10 rounded-full",children:(0,a.jsx)(x.Z,{className:"w-12 h-12 text-adorable-blue"})}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-700 mb-2",children:v?"D\xe9posez les fichiers ici !":"Choisir des fichiers XML"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Supporte les fichiers XML jusqu'\xe0 16 Mo chacun"})]})]})]}),(0,a.jsx)(m.M,{children:s.length>0&&(0,a.jsxs)(i.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-3",children:[(0,a.jsxs)("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[(0,a.jsx)(l.Z,{className:"w-5 h-5"}),"Fichiers S\xe9lectionn\xe9s (",s.length,")"]}),(0,a.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:s.map(e=>(0,a.jsxs)(i.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"flex items-center justify-between p-3 bg-white/50 rounded-lg border border-gray-200 hover:border-adorable-blue/50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-adorable-blue/10 rounded-lg",children:(0,a.jsx)(l.Z,{className:"w-5 h-5 text-adorable-blue"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-800 truncate max-w-xs",children:e.file.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:y(e.file.size)})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:["completed"===e.status&&(0,a.jsx)(p.Z,{className:"w-5 h-5 text-green-500"}),"error"===e.status&&(0,a.jsx)(b.Z,{className:"w-5 h-5 text-red-500"}),(0,a.jsx)(i.E.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>c(e.id),className:"p-1 hover:bg-red-100 rounded-full transition-colors",children:(0,a.jsx)(j.Z,{className:"w-4 h-4 text-red-500"})})]})]},e.id))})]})}),s.length>0&&(0,a.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex justify-end pt-4",children:(0,a.jsxs)(i.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:t,className:"adorable-button text-white font-semibold px-8 py-3 rounded-xl inline-flex items-center gap-2",children:["Continuer",(0,a.jsx)(i.E.div,{animate:{x:[0,5,0]},transition:{repeat:1/0,duration:1.5},children:"→"})]})})]})}var k=s(9036),T=s(8956),C=s(4322),Z=s(6264),S=s(2894),D=s(6141),F=s(4280);function A(e){var t,s,n;let{onComplete:c}=e,{files:o,startProcessing:d,isProcessing:m,currentStage:x,results:u,refreshProgress:h,overallProgress:g,sessionId:f}=N(),[b,j]=(0,r.useState)(new Date),[v,y]=(0,r.useState)(!0),[w,E]=(0,r.useState)(3e3),[A,I]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(!v||!m)return;let e=setInterval(()=>{null==h||h(),j(new Date)},w);return()=>clearInterval(e)},[v,m,w,h]),(0,r.useEffect)(()=>{m||u||d()},[d,m,u]),(0,r.useEffect)(()=>{u&&(console.log("Results detected, transitioning to results view in 2 seconds...",u),setTimeout(()=>{console.log("Calling onComplete to show results display"),c()},2e3))},[u,c]);let P=[{id:"sign",title:"Signature Num\xe9rique",description:"Signature \xe9lectronique avec ANCE SEAL",icon:k.Z,color:"text-blue-500",bgColor:"bg-blue-500",gradientFrom:"from-blue-400",gradientTo:"to-blue-600"},{id:"save",title:"Sauvegarde TTN",description:"Envoi vers le syst\xe8me TTN",icon:l.Z,color:"text-green-500",bgColor:"bg-green-500",gradientFrom:"from-green-400",gradientTo:"to-green-600"},{id:"validate",title:"Validation ANCE",description:"V\xe9rification de la signature",icon:p.Z,color:"text-purple-500",bgColor:"bg-purple-500",gradientFrom:"from-purple-400",gradientTo:"to-purple-600"},{id:"transform",title:"Transformation",description:"Conversion des formats",icon:T.Z,color:"text-orange-500",bgColor:"bg-orange-500",gradientFrom:"from-orange-400",gradientTo:"to-orange-600"},{id:"package",title:"Archivage ZIP",description:"Cr\xe9ation de l'archive finale",icon:C.Z,color:"text-pink-500",bgColor:"bg-pink-500",gradientFrom:"from-pink-400",gradientTo:"to-pink-600"}],M=()=>{if(o.length>0){let e=["sign","save","validate","transform","package"],t="sign";return o.forEach(s=>{e.indexOf(s.stage)>e.indexOf(t)&&(t=s.stage)}),t}if(!x)return"sign";let e=x.toLowerCase();return e.includes("sign")?"sign":e.includes("save")?"save":e.includes("validate")?"validate":e.includes("transform")?"transform":e.includes("package")?"package":"sign"},O=e=>{let t=o.length>0?o:[];if(0===t.length)return"pending";let s=["sign","save","validate","transform","package"],a=s.indexOf(e),r=t.filter(t=>t.stage===e).filter(e=>"processing"===e.status),i=t.filter(e=>{let t=s.indexOf(e.stage);return t>a||t===a&&"completed"===e.status});if(r.length>0)return"active";if(i.length===t.length)return"completed";{let e=M(),t=s.indexOf(e);return a===t?"active":a<t?"completed":"pending"}},z=e=>{let t=o.length>0?o:[];if(0===t.length)return 0;let s=["sign","save","validate","transform","package"],a=s.indexOf(e),r=t.filter(t=>t.stage===e),i=t.filter(e=>{let t=s.indexOf(e.stage);return t>a||t===a&&"completed"===e.status});return i.length===t.length?100:e===M()&&r.length>0?Math.round(r.reduce((e,t)=>e+t.progress,0)/r.length):i.length>0?Math.round(i.length/t.length*100):r.length>0?Math.round(r.reduce((e,t)=>e+t.progress,0)/r.length):i.length>0?Math.round(i.length/t.length*100):0},L=e=>o.filter(t=>t.stage===e&&"processing"===t.status).length,R=(null==u?void 0:u.success)||o.length>0&&o.every(e=>"completed"===e.status),H=o.length>0&&o.every(e=>"completed"===e.status||"error"===e.status);return(0,r.useEffect)(()=>{H&&!u&&setTimeout(()=>{},500)},[H,u]),(0,a.jsxs)("div",{className:"space-y-8 relative",children:[(0,a.jsxs)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[m&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:.1},className:"absolute inset-0 bg-gradient-to-br from-blue-400 via-purple-400 to-pink-400"}),[...Array(6)].map((e,t)=>(0,a.jsx)(i.E.div,{initial:{x:Math.random()*window.innerWidth,y:window.innerHeight+50,opacity:0},animate:{y:-50,opacity:[0,1,0],x:Math.random()*window.innerWidth},transition:{duration:4+2*Math.random(),repeat:1/0,delay:.5*t},className:"absolute w-2 h-2 bg-blue-400 rounded-full"},t))]}),R&&(0,a.jsx)(a.Fragment,{children:[...Array(20)].map((e,t)=>(0,a.jsx)(i.E.div,{initial:{x:window.innerWidth/2,y:window.innerHeight/2,opacity:1,scale:0},animate:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight,opacity:0,scale:1,rotate:360*Math.random()},transition:{duration:2,ease:"easeOut"},className:"absolute w-3 h-3 ".concat(["bg-green-400","bg-blue-400","bg-purple-400","bg-pink-400","bg-yellow-400"][t%5]," rounded-full")},"confetti-".concat(t)))})]}),(0,a.jsxs)("div",{className:"text-center relative z-10",children:[(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},children:[(0,a.jsx)("h2",{className:"text-3xl font-display font-bold text-gray-800 mb-2 bg-gradient-to-r from-adorable-blue to-adorable-purple bg-clip-text text-transparent",children:"Traitement de vos Factures \xc9lectroniques"}),(0,a.jsx)("p",{className:"text-gray-600 mb-2",children:"Workflow unifi\xe9 IconeSign - Signature, Validation & Archivage"}),(0,a.jsx)(i.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium mb-4 ".concat(m?"bg-blue-100 text-blue-700 border border-blue-200":(null==u?void 0:u.success)?"bg-green-100 text-green-700 border border-green-200":u&&!u.success?"bg-red-100 text-red-700 border border-red-200":"bg-gray-100 text-gray-600 border border-gray-200"),children:m?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.E.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},children:(0,a.jsx)(Z.Z,{className:"w-4 h-4"})}),(0,a.jsx)("span",{children:"Traitement en cours..."})]}):(null==u?void 0:u.success)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Traitement termin\xe9 avec succ\xe8s"})]}):u&&!u.success?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Traitement termin\xe9 avec des erreurs"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"En attente de d\xe9marrage"})]})})]}),(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"flex flex-wrap items-center justify-center gap-4 text-sm text-gray-500 bg-gray-50 rounded-lg p-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.E.div,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:(0,a.jsx)(D.Z,{className:"w-4 h-4 text-blue-500"})}),(0,a.jsxs)("span",{children:["Derni\xe8re mise \xe0 jour: ",b.toLocaleTimeString("fr-FR")]})]}),(0,a.jsxs)(i.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{null==h||h(),j(new Date)},disabled:!m,className:"flex items-center gap-1 px-3 py-1 rounded-full bg-white hover:bg-blue-50 transition-colors disabled:opacity-50 border border-gray-200 shadow-sm",children:[(0,a.jsx)(i.E.div,{animate:m?{rotate:360}:{},transition:{duration:1,repeat:m?1/0:0,ease:"linear"},children:(0,a.jsx)(F.Z,{className:"w-3 h-3"})}),(0,a.jsx)("span",{children:"Actualiser"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:v,onChange:e=>y(e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)("span",{className:"select-none",children:"Auto-actualisation"}),v&&(0,a.jsx)(i.E.div,{animate:{scale:[1,1.2,1]},transition:{duration:1,repeat:1/0},className:"w-2 h-2 bg-green-500 rounded-full"})]}),v&&(0,a.jsxs)("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[(0,a.jsx)(D.Z,{className:"w-3 h-3"}),(0,a.jsxs)("span",{children:["Toutes les ",w/1e3,"s"]})]}),f&&(0,a.jsx)("button",{onClick:async()=>{console.log("Manual progress fetch for session:",f),await (null==h?void 0:h())},className:"text-xs px-2 py-1 bg-yellow-100 text-yellow-700 rounded hover:bg-yellow-200",children:"Test Progress API"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-lg font-bold text-gray-800",children:"Progression Globale"}),(0,a.jsx)(i.E.div,{animate:{rotate:m?360:0},transition:{duration:2,repeat:m?1/0:0,ease:"linear"},className:"w-6 h-6 rounded-full ".concat(m?"bg-blue-500":"bg-green-500"),children:m?(0,a.jsx)(Z.Z,{className:"w-6 h-6 text-white"}):(0,a.jsx)(p.Z,{className:"w-6 h-6 text-white"})})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-sm font-bold text-gray-700",children:[o.filter(e=>"completed"===e.status).length," / ",o.length," fichiers"]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[Math.round(o.filter(e=>"completed"===e.status).length/o.length*100),"% termin\xe9"]})]})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-4 shadow-inner",children:(0,a.jsx)(i.E.div,{initial:{width:0},animate:{width:"".concat(o.filter(e=>"completed"===e.status).length/o.length*100,"%")},transition:{duration:1,ease:"easeOut"},className:"bg-gradient-to-r from-adorable-pink via-adorable-purple to-adorable-blue h-4 rounded-full shadow-lg relative overflow-hidden",children:(0,a.jsx)(i.E.div,{initial:{x:"-100%"},animate:{x:"100%"},transition:{duration:2,repeat:1/0,ease:"linear"},className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent"})})}),(0,a.jsx)(i.E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsxs)("span",{className:"text-xs font-bold text-white drop-shadow-lg",children:[Math.round(o.filter(e=>"completed"===e.status).length/o.length*100),"%"]})})]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(i.E.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"inline-flex items-center justify-center w-16 h-16 bg-adorable-blue/10 rounded-full mb-4",children:(0,a.jsx)(Z.Z,{className:"w-8 h-8 text-adorable-blue"})}),(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-800 mb-2",children:x})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 text-center",children:"\xc9tapes du Workflow"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:P.map((e,t)=>{let s=e.icon,r=O(e.id),l=z(e.id);return(0,a.jsxs)(i.E.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:.1*t},className:"\n                  flex flex-col items-center gap-3 p-4 rounded-xl border-2 transition-all duration-300 relative overflow-hidden\n                  ".concat("completed"===r?"bg-gradient-to-br from-green-50 to-green-100 border-green-200 shadow-lg":"active"===r?"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200 shadow-lg":"bg-white/50 border-gray-200","\n                "),children:["active"===r&&(0,a.jsx)(i.E.div,{initial:{x:"-100%"},animate:{x:"100%"},transition:{duration:2,repeat:1/0,ease:"linear"},className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),(0,a.jsxs)(i.E.div,{animate:"active"===r?{scale:[1,1.05,1]}:{},transition:{duration:2,repeat:1/0},className:"\n                    w-20 h-20 rounded-full border-3 flex items-center justify-center relative z-10\n                    ".concat("completed"===r?"bg-gradient-to-br ".concat(e.gradientFrom," ").concat(e.gradientTo," border-transparent text-white shadow-xl"):"active"===r?"bg-gradient-to-br from-adorable-blue to-blue-600 border-blue-300 text-white shadow-xl":"bg-gray-100 border-gray-300 text-gray-400","\n                  "),children:["completed"===r?(0,a.jsx)(i.E.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200},children:(0,a.jsx)(p.Z,{className:"w-10 h-10"})}):"active"===r?(0,a.jsx)(i.E.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},children:(0,a.jsx)(Z.Z,{className:"w-10 h-10"})}):(0,a.jsx)(s,{className:"w-10 h-10"}),"active"===r&&l>0&&(0,a.jsxs)("svg",{className:"absolute inset-0 w-20 h-20 transform -rotate-90",children:[(0,a.jsx)("circle",{cx:"40",cy:"40",r:"36",stroke:"currentColor",strokeWidth:"3",fill:"none",className:"text-blue-200"}),(0,a.jsx)(i.E.circle,{cx:"40",cy:"40",r:"36",stroke:"currentColor",strokeWidth:"3",fill:"none",strokeLinecap:"round",className:"text-white",initial:{strokeDasharray:"0 226"},animate:{strokeDasharray:"".concat(l/100*226," 226")},transition:{duration:1}})]}),(0,a.jsxs)(i.E.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.5},className:"\n                      absolute -top-1 -right-1 w-6 h-6 rounded-full border-3 border-white flex items-center justify-center\n                      ".concat("completed"===r?"bg-green-500":"active"===r?"bg-blue-500 animate-pulse":"bg-gray-300","\n                    "),children:["completed"===r&&(0,a.jsx)(p.Z,{className:"w-4 h-4 text-white"}),"active"===r&&l>0&&(0,a.jsxs)("span",{className:"text-xs font-bold text-white",children:[l,"%"]})]})]}),(0,a.jsxs)("div",{className:"text-center z-10 relative",children:[(0,a.jsx)(i.E.div,{className:"text-sm font-bold mb-1 transition-colors duration-300 ".concat("completed"===r?e.color:"active"===r?"text-adorable-blue":"text-gray-500"),animate:"active"===r?{scale:[1,1.02,1]}:{},transition:{duration:2,repeat:1/0},children:e.title}),(0,a.jsx)("div",{className:"text-xs text-gray-600 mb-2 leading-tight",children:e.description}),(0,a.jsx)(i.E.div,{className:"text-xs font-bold px-2 py-1 rounded-full transition-all duration-300 ".concat("completed"===r?"bg-green-100 text-green-700 border border-green-200":"active"===r?"bg-blue-100 text-blue-700 border border-blue-200":"bg-gray-100 text-gray-500 border border-gray-200"),animate:"active"===r?{scale:[1,1.05,1]}:{},transition:{duration:1.5,repeat:1/0},children:"completed"===r?(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(p.Z,{className:"w-3 h-3"}),"Termin\xe9"]}):"active"===r?(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(Z.Z,{className:"w-3 h-3 animate-spin"}),l>0?"".concat(l,"%"):"En cours..."]}):(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(D.Z,{className:"w-3 h-3"}),"En attente"]})}),"active"===r&&(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"text-xs text-blue-600 mt-1 font-medium space-y-1",children:[(0,a.jsxs)("div",{children:[L(e.id)," fichier(s) actif(s)"]}),l>0&&l<100&&(0,a.jsx)("div",{className:"w-full bg-blue-200 rounded-full h-1",children:(0,a.jsx)(i.E.div,{initial:{width:0},animate:{width:"".concat(l,"%")},transition:{duration:.5},className:"bg-blue-600 h-1 rounded-full"})})]}),"completed"===r&&(0,a.jsx)(i.E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-xs text-green-600 mt-1 font-medium",children:"✓ Tous les fichiers termin\xe9s"})]}),t<P.length-1&&(0,a.jsx)("div",{className:"hidden md:block absolute top-10 left-full w-4 h-0.5 bg-gray-300 transform translate-x-2",children:"completed"===r&&(0,a.jsx)(i.E.div,{initial:{width:0},animate:{width:"100%"},transition:{duration:.5,delay:.2},className:"h-full bg-green-400"})})]},e.id)})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-800",children:"Progression D\xe9taill\xe9e des Fichiers"}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[o.filter(e=>"completed"===e.status).length," termin\xe9(s) • "," ",o.filter(e=>"processing"===e.status).length," en cours • "," ",o.filter(e=>"error"===e.status).length," erreur(s)"]})]}),(0,a.jsx)("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:o.map(e=>{var t;let s=e=>({sign:"Signature num\xe9rique",save:"Sauvegarde TTN",validate:"Validation ANCE",transform:"Transformation",package:"Archivage ZIP",idle:"En attente",processing:"Traitement en cours",complete:"Termin\xe9"})[e]||e.charAt(0).toUpperCase()+e.slice(1);return(0,a.jsxs)(i.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex items-center justify-between p-4 rounded-lg border-2 transition-all ".concat((e=>{switch(e){case"completed":return"border-green-200 bg-green-50";case"error":return"border-red-200 bg-red-50";case"processing":return"border-blue-200 bg-blue-50";default:return"border-gray-200 bg-white/50"}})(e.status)),children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg ".concat("completed"===e.status?"bg-green-100":"error"===e.status?"bg-red-100":"bg-adorable-blue/10"),children:r.createElement((t=e.stage,({sign:k.Z,save:l.Z,validate:p.Z,transform:T.Z,package:C.Z})[t]||l.Z),{className:"w-5 h-5 ".concat("completed"===e.status?"text-green-600":"error"===e.status?"text-red-600":"text-adorable-blue")})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"font-medium text-gray-800 text-sm truncate",children:e.file.name}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600",children:s(e.stage)}),"processing"===e.status&&(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:"w-1 h-1 bg-blue-500 rounded-full animate-pulse"}),(0,a.jsx)("div",{className:"w-1 h-1 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"0.2s"}}),(0,a.jsx)("div",{className:"w-1 h-1 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"0.4s"}})]})]}),"processing"===e.status&&e.progress>0&&(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2 overflow-hidden",children:(0,a.jsx)(i.E.div,{initial:{width:0},animate:{width:"".concat(e.progress,"%")},transition:{duration:.8,ease:"easeOut"},className:"bg-gradient-to-r from-adorable-blue to-blue-600 h-2 rounded-full relative",children:(0,a.jsx)(i.E.div,{initial:{x:"-100%"},animate:{x:"100%"},transition:{duration:1.5,repeat:1/0,ease:"linear"},className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent"})})}),"completed"===e.status&&(0,a.jsx)("div",{className:"w-full bg-green-200 rounded-full h-1 mt-2",children:(0,a.jsx)("div",{className:"bg-green-500 h-1 rounded-full w-full"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:[(e.file.size/1024).toFixed(1)," KB"]}),(0,a.jsx)("div",{className:"flex items-center",children:"completed"===e.status?(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(p.Z,{className:"w-5 h-5 text-green-500"}),(0,a.jsx)("span",{className:"text-xs text-green-600 font-medium",children:"Termin\xe9"})]}):"error"===e.status?(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(S.Z,{className:"w-5 h-5 text-red-500"}),(0,a.jsx)("span",{className:"text-xs text-red-600 font-medium",children:"Erreur"})]}):(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(i.E.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:(0,a.jsx)(Z.Z,{className:"w-5 h-5 text-adorable-blue"})}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-xs text-blue-600 font-medium",children:e.progress>0?"".concat(e.progress,"%"):"En cours"}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:s(e.stage)})]})]})})]})]},e.id)})}),0===o.length&&(0,a.jsxs)(i.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center py-12 text-gray-500",children:[(0,a.jsx)(i.E.div,{animate:{rotate:[0,10,-10,0]},transition:{duration:2,repeat:1/0},children:(0,a.jsx)(l.Z,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"})}),(0,a.jsx)("p",{className:"text-lg font-medium",children:"Aucun fichier en cours de traitement"}),(0,a.jsx)("p",{className:"text-sm",children:"Le workflow d\xe9marrera automatiquement"})]})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("button",{onClick:()=>I(!A),className:"text-xs text-gray-500 hover:text-gray-700 underline",children:[A?"Masquer":"Afficher"," les informations de d\xe9bogage"]}),A&&(0,a.jsxs)(i.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mt-2 p-4 bg-gray-100 rounded-lg text-xs font-mono",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-bold mb-2",children:"\xc9tat du Store:"}),(0,a.jsxs)("div",{children:["Session ID: ",f||"Non d\xe9fini"]}),(0,a.jsxs)("div",{children:["En traitement: ",m?"Oui":"Non"]}),(0,a.jsxs)("div",{children:["\xc9tape actuelle: ",x]}),(0,a.jsxs)("div",{children:["Progression globale: ",g,"%"]}),(0,a.jsxs)("div",{children:["Nombre de fichiers: ",o.length]}),(0,a.jsxs)("div",{children:["Auto-refresh: ",v?"Activ\xe9":"D\xe9sactiv\xe9"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-bold mb-2",children:"Fichiers:"}),o.map((e,t)=>(0,a.jsxs)("div",{className:"mb-1",children:[(0,a.jsx)("div",{children:e.file.name}),(0,a.jsxs)("div",{className:"ml-2 text-gray-600",children:["Status: ",e.status," | Stage: ",e.stage," | Progress: ",e.progress,"%"]})]},t))]})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h4",{className:"font-bold mb-2",children:"D\xe9tection des \xe9tapes:"}),(0,a.jsxs)("div",{children:["\xc9tape API d\xe9tect\xe9e: ",M()]}),P.map(e=>(0,a.jsxs)("div",{className:"ml-2",children:[e.id,": ",O(e.id)," (",z(e.id),"%)"]},e.id))]})]})]}),o.length>0&&(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-gradient-to-r from-gray-50 to-blue-50 rounded-xl p-6 border border-gray-200",children:[(0,a.jsxs)("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[(0,a.jsx)(i.E.div,{animate:{rotate:m?360:0},transition:{duration:3,repeat:m?1/0:0,ease:"linear"},children:"\uD83D\uDCCA"}),"R\xe9sum\xe9 du Traitement"]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsxs)(i.E.div,{whileHover:{scale:1.05},className:"bg-white rounded-lg p-4 text-center shadow-sm border",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:o.length}),(0,a.jsx)("div",{className:"text-xs text-gray-600",children:"Total Fichiers"})]}),(0,a.jsxs)(i.E.div,{whileHover:{scale:1.05},className:"bg-white rounded-lg p-4 text-center shadow-sm border",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:o.filter(e=>"completed"===e.status).length}),(0,a.jsx)("div",{className:"text-xs text-gray-600",children:"Termin\xe9s"})]}),(0,a.jsxs)(i.E.div,{whileHover:{scale:1.05},className:"bg-white rounded-lg p-4 text-center shadow-sm border",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:o.filter(e=>"processing"===e.status).length}),(0,a.jsx)("div",{className:"text-xs text-gray-600",children:"En Cours"})]}),(0,a.jsxs)(i.E.div,{whileHover:{scale:1.05},className:"bg-white rounded-lg p-4 text-center shadow-sm border",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-red-600",children:o.filter(e=>"error"===e.status).length}),(0,a.jsx)("div",{className:"text-xs text-gray-600",children:"Erreurs"})]})]}),(0,a.jsxs)(i.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"mt-6 bg-white rounded-lg p-4 border border-gray-200",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:"\xc9tape Actuelle:"}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-adorable-blue flex items-center justify-center",children:(0,a.jsx)(i.E.div,{animate:{rotate:m?360:0},transition:{duration:2,repeat:m?1/0:0,ease:"linear"},children:r.createElement((null===(t=P.find(e=>e.id===M()))||void 0===t?void 0:t.icon)||k.Z,{className:"w-4 h-4 text-white"})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-lg font-bold text-adorable-blue",children:null===(s=P.find(e=>e.id===M()))||void 0===s?void 0:s.title}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:null===(n=P.find(e=>e.id===M()))||void 0===n?void 0:n.description})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-adorable-blue",children:[Math.round(g),"%"]}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Progression"})]})]}),(0,a.jsx)("div",{className:"mt-3 w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)(i.E.div,{initial:{width:0},animate:{width:"".concat(g,"%")},transition:{duration:1},className:"bg-gradient-to-r from-adorable-blue to-blue-600 h-2 rounded-full"})})]})]})]})}function I(e){let{onBack:t,onStartOver:s}=e,{results:r,reset:n}=N();if(!r)return null;let o=async()=>{if(r.zipDownloadUrl)try{let e=document.createElement("a");e.href=r.zipDownloadUrl,e.download="processed_invoices.zip",e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e),w.Am.success("T\xe9l\xe9chargement commenc\xe9!")}catch(e){w.Am.error("\xc9chec du t\xe9l\xe9chargement des fichiers")}},d=Math.round(r.successfulFiles/r.totalFiles*100);return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(i.E.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200},className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-green-400 to-green-600 rounded-full mb-4",children:r.success?(0,a.jsx)(p.Z,{className:"w-10 h-10 text-white"}):(0,a.jsx)(b.Z,{className:"w-10 h-10 text-white"})}),(0,a.jsx)("h2",{className:"text-2xl font-display font-bold text-gray-800 mb-2",children:r.success?"Traitement Termin\xe9 ! \uD83C\uDF89":"Traitement Fini"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:r.message})]}),(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-xl",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:r.totalFiles}),(0,a.jsx)("div",{className:"text-sm text-blue-800",children:"Total Fichiers"})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-xl",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:r.successfulFiles}),(0,a.jsx)("div",{className:"text-sm text-green-800",children:"R\xe9ussis"})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-red-50 rounded-xl",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-red-600",children:r.failedFiles}),(0,a.jsx)("div",{className:"text-sm text-red-800",children:"\xc9chou\xe9s"})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-xl",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:[d,"%"]}),(0,a.jsx)("div",{className:"text-sm text-purple-800",children:"Taux de R\xe9ussite"})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[(0,a.jsx)(l.Z,{className:"w-5 h-5"}),"R\xe9sultats des Fichiers"]}),(0,a.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:r.files.map(e=>(0,a.jsx)(i.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"\n                p-4 rounded-lg border-2 transition-all duration-300\n                ".concat("completed"===e.status?"bg-green-50 border-green-200":"bg-red-50 border-red-200","\n              "),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:["completed"===e.status?(0,a.jsx)(p.Z,{className:"w-5 h-5 text-green-600"}):(0,a.jsx)(b.Z,{className:"w-5 h-5 text-red-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-800",children:e.file.name}),e.ttnInvoiceId&&(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["TTN ID: ",e.ttnInvoiceId]}),e.error&&(0,a.jsxs)("p",{className:"text-sm text-red-600",children:["Erreur : ",e.error]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"\n                    text-sm font-medium capitalize\n                    ".concat("completed"===e.status?"text-green-600":"text-red-600","\n                  "),children:e.status}),(0,a.jsx)("div",{className:"text-xs text-gray-500 capitalize",children:e.stage.replace("_"," ")})]})]})},e.id))})]}),r.zipDownloadUrl&&(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-adorable-pink/10 to-adorable-blue/10 rounded-2xl p-6 border border-adorable-blue/20",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)(C.Z,{className:"w-6 h-6 text-adorable-blue"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Vos Fichiers sont Pr\xeats !"}),(0,a.jsx)(c.Z,{className:"w-5 h-5 text-adorable-pink"})]}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"T\xe9l\xe9chargez votre archive ZIP compl\xe8te contenant :"}),(0,a.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1 mb-6",children:[(0,a.jsxs)("li",{children:["\uD83D\uDCC1 ",(0,a.jsx)("strong",{children:"Facture_xml_Signee/"})," - Factures XML sign\xe9es num\xe9riquement"]}),(0,a.jsxs)("li",{children:["\uD83D\uDCC1 ",(0,a.jsx)("strong",{children:"Rapport_de_Validation/"})," - Rapports de validation JSON"]}),(0,a.jsxs)("li",{children:["\uD83D\uDCC1 ",(0,a.jsx)("strong",{children:"Facture_Pdf/"})," - Fichiers d'aper\xe7u HTML"]}),(0,a.jsxs)("li",{children:["\uD83D\uDCC4 ",(0,a.jsx)("strong",{children:"resume_de_traitement.txt"})," - R\xe9sum\xe9 complet"]})]}),(0,a.jsxs)(i.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:o,className:"adorable-button text-white font-semibold px-8 py-3 rounded-xl inline-flex items-center gap-2 w-full justify-center",children:[(0,a.jsx)(h.Z,{className:"w-5 h-5"}),"T\xe9l\xe9charger l'Archive Compl\xe8te"]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t border-gray-200",children:[(0,a.jsx)(i.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:t,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl font-medium hover:bg-gray-50 transition-colors",children:"Voir la Progression"}),(0,a.jsxs)(i.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{n(),s()},className:"flex-1 px-6 py-3 border border-adorable-blue text-adorable-blue rounded-xl font-medium hover:bg-adorable-blue/5 transition-colors inline-flex items-center justify-center gap-2",children:[(0,a.jsx)(F.Z,{className:"w-4 h-4"}),"Traiter Plus de Fichiers"]})]})]})}var P=s(7972),M=s(3523),O=s(1295),z=s(2812),L=s(9409),R=s(5883),H=s(7593);function _(){let{user:e,signOut:t}=(0,H.t)(),[s,l]=(0,r.useState)(!1);return e?(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)(i.E.button,{onClick:()=>l(!s),whileHover:{scale:1.02},whileTap:{scale:.98},className:"flex items-center gap-3 bg-white/10 backdrop-blur-sm rounded-lg px-4 py-2 text-white hover:bg-white/20 transition-colors",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-adorable-pink to-adorable-purple rounded-full flex items-center justify-center",children:(0,a.jsx)(P.Z,{className:"w-4 h-4 text-white"})}),(0,a.jsxs)("div",{className:"text-left hidden sm:block",children:[(0,a.jsxs)("div",{className:"text-sm font-medium",children:[e.firstName," ",e.lastName]}),(0,a.jsx)("div",{className:"text-xs text-white/70",children:e.companyName||e.email})]}),(0,a.jsx)(M.Z,{className:"w-4 h-4 transition-transform ".concat(s?"rotate-180":"")})]}),(0,a.jsx)(m.M,{children:s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>l(!1)}),(0,a.jsxs)(i.E.div,{initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.2},className:"absolute right-0 top-full mt-2 w-80 bg-white rounded-xl shadow-2xl border border-gray-200 z-50 overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-adorable-blue to-adorable-purple p-4 text-white",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center",children:(0,a.jsx)(P.Z,{className:"w-6 h-6"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-semibold",children:[e.firstName," ",e.lastName]}),(0,a.jsxs)("div",{className:"text-sm text-white/80",children:["@",e.username]})]})]})}),(0,a.jsxs)("div",{className:"p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[(0,a.jsx)(O.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:e.email})]}),e.companyName&&(0,a.jsxs)("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[(0,a.jsx)(z.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:e.companyName})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[(0,a.jsx)(k.Z,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:["R\xf4le: ",e.role]})]}),(0,a.jsx)("div",{className:"pt-2 border-t border-gray-100",children:(0,a.jsx)("div",{className:"flex items-center gap-2 text-sm",children:e.hasCredentials?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.Z,{className:"w-4 h-4 text-green-500"}),(0,a.jsx)("span",{className:"text-green-600",children:"Identifiants configur\xe9s"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full bg-yellow-500"}),(0,a.jsx)("span",{className:"text-yellow-600",children:"Identifiants manquants"})]})})})]}),(0,a.jsxs)("div",{className:"border-t border-gray-100",children:[(0,a.jsxs)("button",{onClick:()=>{l(!1)},className:"w-full flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-gray-50 transition-colors",children:[(0,a.jsx)(L.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Param\xe8tres"})]}),(0,a.jsxs)("button",{onClick:()=>{t(),window.location.reload()},className:"w-full flex items-center gap-3 px-4 py-3 text-red-600 hover:bg-red-50 transition-colors",children:[(0,a.jsx)(R.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Se d\xe9connecter"})]})]})]})]})})]}):null}function q(e){let{onBack:t}=e,[s,l]=(0,r.useState)("upload"),{files:n,results:c,startProcessing:o}=N();console.log("WorkflowProcessor state:",{currentStep:s,hasResults:!!c,filesCount:n.length});let d=[{id:"upload",title:"T\xe9l\xe9charger",icon:x.Z,color:"bg-blue-500"},{id:"processing",title:"Traiter",icon:u.Z,color:"bg-green-500"},{id:"results",title:"R\xe9sultats",icon:h.Z,color:"bg-pink-500"}],f=async()=>{"upload"===s&&n.length>0?(l("processing"),await o()):"processing"===s&&c&&l("results")};return(0,a.jsx)("div",{className:"min-h-screen py-8",children:(0,a.jsxs)("div",{className:"container mx-auto px-4",children:[(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex items-center justify-between mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(i.E.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:t,className:"p-3 rounded-full bg-white/80 backdrop-blur-sm border border-white/20 shadow-lg hover:shadow-xl transition-all duration-300",children:(0,a.jsx)(g.Z,{className:"w-6 h-6 text-gray-700"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-display font-bold text-gray-800",children:"Procesus de Traitement des Factures"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Workflow complet pour vos factures XML"})]})]}),(0,a.jsx)(_,{})]}),(0,a.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"adorable-card p-6 mb-8",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:d.map((e,t)=>{let r=e.icon,l=e.id===s,n=d.findIndex(e=>e.id===s)>t;return(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(i.E.div,{whileHover:{scale:1.1},className:"\n                      workflow-step\n                      ".concat(l?"active":"","\n                      ").concat(n?"completed":"","\n                      ").concat(l||n?"":"pending","\n                    "),children:n?(0,a.jsx)(p.Z,{className:"w-6 h-6"}):(0,a.jsx)(r,{className:"w-6 h-6"})}),(0,a.jsx)("div",{className:"ml-3 hidden md:block",children:(0,a.jsx)("div",{className:"font-semibold ".concat(l?"text-adorable-blue":n?"text-green-600":"text-gray-500"),children:e.title})}),t<d.length-1&&(0,a.jsx)("div",{className:"hidden md:block w-16 h-0.5 mx-4 ".concat(n?"bg-green-500":"bg-gray-300")})]},e.id)})})}),(0,a.jsx)(m.M,{mode:"wait",children:(0,a.jsxs)(i.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"adorable-card p-8",children:["upload"===s&&(0,a.jsx)(E,{onNext:f}),"processing"===s&&(0,a.jsx)(A,{onComplete:()=>l("results")}),"results"===s&&(0,a.jsx)(I,{onBack:()=>{"processing"===s?l("upload"):"results"===s&&l("processing")},onStartOver:()=>{l("upload")}})]},s)})]})})}function U(e){let{onBack:t}=e,[s,n]=(0,r.useState)({idSaveEfact:"",generatedRef:"",dateFrom:"",dateTo:"",status:""}),[c,o]=(0,r.useState)(!1),[m,x]=(0,r.useState)(null),[u,h]=(0,r.useState)(!1),f=async()=>{o(!0),x(null);try{let e=Object.fromEntries(Object.entries(s).filter(e=>{let[t,s]=e;return s&&""!==s.trim()})),t=localStorage.getItem("auth_token");if(!t){w.Am.error("Vous devez \xeatre connect\xe9 pour consulter les factures");return}let a=await fetch("".concat("https://itchy-cars-march.loca.lt/api/v1","/ttn/consult"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({criteria:e})}),r=await a.json();a.ok?(x(r),r.success?w.Am.success("Consultation r\xe9ussie - ".concat(r.count," facture(s) trouv\xe9e(s)")):w.Am.error(r.error||"Erreur lors de la consultation")):(w.Am.error(r.error||"Erreur lors de la consultation"),x(r))}catch(e){console.error("Erreur de consultation:",e),w.Am.error("Erreur de connexion au serveur")}finally{o(!1)}};return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(i.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,a.jsx)(g.Z,{className:"w-6 h-6 text-gray-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-display font-bold text-gray-800",children:"Consultation TTN E-Facturation"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Consultez vos factures \xe9lectroniques dans le syst\xe8me TTN"})]})]}),(0,a.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-blue-50 rounded-2xl p-6 border border-blue-200",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(P.Z,{className:"w-5 h-5 text-blue-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-blue-800",children:"Identifiants TTN"}),(0,a.jsx)("p",{className:"text-blue-600 text-sm",children:"Utilisation des identifiants TTN configur\xe9s dans votre profil utilisateur."})]})]})}),(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-2xl p-6 border border-gray-200 shadow-sm",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[(0,a.jsx)(d.Z,{className:"w-5 h-5 text-adorable-purple"}),"Crit\xe8res de Recherche"]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ID Save E-Fact"}),(0,a.jsx)("input",{type:"text",value:s.idSaveEfact,onChange:e=>n(t=>({...t,idSaveEfact:e.target.value})),className:"adorable-input w-full px-4 py-3 text-gray-800 placeholder-gray-400",placeholder:"ID de sauvegarde"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"R\xe9f\xe9rence G\xe9n\xe9r\xe9e"}),(0,a.jsx)("input",{type:"text",value:s.generatedRef,onChange:e=>n(t=>({...t,generatedRef:e.target.value})),className:"adorable-input w-full px-4 py-3 text-gray-800 placeholder-gray-400",placeholder:"R\xe9f\xe9rence de la facture"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de d\xe9but"}),(0,a.jsx)("input",{type:"date",value:s.dateFrom,onChange:e=>n(t=>({...t,dateFrom:e.target.value})),className:"adorable-input w-full px-4 py-3 text-gray-800"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de fin"}),(0,a.jsx)("input",{type:"date",value:s.dateTo,onChange:e=>n(t=>({...t,dateTo:e.target.value})),className:"adorable-input w-full px-4 py-3 text-gray-800"})]})]}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsxs)(i.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:f,disabled:c,className:"adorable-button text-white font-semibold px-8 py-3 rounded-xl inline-flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[c?(0,a.jsx)(Z.Z,{className:"w-5 h-5 animate-spin"}):(0,a.jsx)(d.Z,{className:"w-5 h-5"}),c?"Consultation en cours...":"Consulter"]})})]}),m&&(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl p-6 border border-gray-200 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[m.success?(0,a.jsx)(p.Z,{className:"w-5 h-5 text-green-500"}):(0,a.jsx)(b.Z,{className:"w-5 h-5 text-red-500"}),"R\xe9sultats de la Consultation"]}),(0,a.jsxs)("button",{onClick:()=>h(!u),className:"text-sm text-adorable-blue hover:text-adorable-purple transition-colors",children:[u?"Masquer":"Voir"," la r\xe9ponse brute"]})]}),m.success?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(l.Z,{className:"w-4 h-4"}),m.count," facture(s) trouv\xe9e(s)"]})}),m.invoices&&m.invoices.length>0?(0,a.jsx)("div",{className:"space-y-2",children:m.invoices.map((e,t)=>(0,a.jsx)("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"ID:"}),(0,a.jsx)("span",{className:"ml-2 text-gray-600",children:e.id||"N/A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"R\xe9f\xe9rence:"}),(0,a.jsx)("span",{className:"ml-2 text-gray-600",children:e.reference||"N/A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Statut:"}),(0,a.jsx)("span",{className:"ml-2 text-gray-600",children:e.status||"N/A"})]})]})},e.id||t))}):(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(l.Z,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),(0,a.jsx)("p",{children:"Aucune facture trouv\xe9e avec ces crit\xe8res"})]})]}):(0,a.jsxs)("div",{className:"text-red-600",children:[(0,a.jsx)("p",{className:"font-medium",children:"Erreur:"}),(0,a.jsx)("p",{className:"text-sm mt-1",children:m.error})]}),u&&m.rawResponse&&(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"R\xe9ponse brute du serveur:"}),(0,a.jsx)("pre",{className:"bg-gray-100 p-4 rounded-lg text-xs overflow-x-auto text-gray-600",children:m.rawResponse})]})]})]})}function V(e){let{icon:t,title:s,description:r,color:l}=e;return(0,a.jsxs)(i.E.div,{whileHover:{scale:1.05,rotateY:5},whileTap:{scale:.95},className:"adorable-card p-6 cursor-pointer group",children:[(0,a.jsx)(i.E.div,{whileHover:{rotate:360},transition:{duration:.6},className:"w-16 h-16 bg-gradient-to-r ".concat(l," rounded-2xl flex items-center justify-center text-white mb-4 shadow-lg group-hover:shadow-xl transition-shadow duration-300"),children:t}),(0,a.jsx)("h3",{className:"text-xl font-display font-semibold text-gray-800 mb-2 group-hover:text-adorable-purple transition-colors duration-300",children:s}),(0,a.jsx)("p",{className:"text-gray-600 leading-relaxed group-hover:text-gray-700 transition-colors duration-300",children:r}),(0,a.jsx)(i.E.div,{initial:{width:0},whileHover:{width:"100%"},transition:{duration:.3},className:"h-1 bg-gradient-to-r ".concat(l," rounded-full mt-4")})]})}function W(){return(0,a.jsxs)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[(0,a.jsx)(i.E.div,{animate:{x:[0,100,0],y:[0,-100,0],rotate:[0,180,360]},transition:{duration:20,repeat:1/0,ease:"linear"},className:"absolute top-20 left-20 w-32 h-32 bg-gradient-to-r from-adorable-pink/20 to-adorable-purple/20 rounded-full blur-xl"}),(0,a.jsx)(i.E.div,{animate:{x:[0,-150,0],y:[0,100,0],rotate:[0,-180,-360]},transition:{duration:25,repeat:1/0,ease:"linear"},className:"absolute top-40 right-32 w-24 h-24 bg-gradient-to-r from-adorable-blue/20 to-adorable-green/20 rounded-full blur-xl"}),(0,a.jsx)(i.E.div,{animate:{x:[0,80,0],y:[0,-80,0],scale:[1,1.2,1]},transition:{duration:15,repeat:1/0,ease:"easeInOut"},className:"absolute bottom-32 left-1/4 w-40 h-40 bg-gradient-to-r from-adorable-yellow/15 to-adorable-orange/15 rounded-full blur-2xl"}),(0,a.jsx)(i.E.div,{animate:{x:[0,-120,0],y:[0,60,0],rotate:[0,90,180]},transition:{duration:18,repeat:1/0,ease:"linear"},className:"absolute bottom-20 right-20 w-28 h-28 bg-gradient-to-r from-adorable-purple/20 to-adorable-pink/20 rounded-full blur-xl"}),Array.from({length:20}).map((e,t)=>(0,a.jsx)(i.E.div,{animate:{opacity:[0,1,0],scale:[0,1,0],rotate:[0,180,360]},transition:{duration:3,repeat:1/0,delay:.2*t,ease:"easeInOut"},className:"absolute w-2 h-2 bg-adorable-pink rounded-full",style:{left:"".concat(100*Math.random(),"%"),top:"".concat(100*Math.random(),"%")}},t)),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50/50 via-transparent to-purple-50/50"})]})}function B(){let[e,t]=(0,r.useState)(!1),[s,m]=(0,r.useState)(!1),x=[{icon:(0,a.jsx)(l.Z,{className:"w-8 h-8"}),title:"Signature Num\xe9rique",description:"Signature conforme XAdES-B avec ANCE SEAL",color:"from-blue-400 to-blue-600"},{icon:(0,a.jsx)(n.Z,{className:"w-8 h-8"}),title:"Int\xe9gration TTN",description:"Int\xe9gration transparente du syst\xe8me e-facturation",color:"from-green-400 to-green-600"},{icon:(0,a.jsx)(c.Z,{className:"w-8 h-8"}),title:"Validation Intelligente",description:"Validation compl\xe8te des signatures XML",color:"from-purple-400 to-purple-600"},{icon:(0,a.jsx)(o.Z,{className:"w-8 h-8"}),title:"R\xe9sultats \xc9l\xe9gants",description:"Archive ZIP organis\xe9e avec tous les fichiers trait\xe9s",color:"from-pink-400 to-pink-600"}];return(0,a.jsxs)("div",{className:"min-h-screen relative overflow-hidden",children:[(0,a.jsx)(W,{}),(0,a.jsx)("div",{className:"relative z-10",children:e||s?e?(0,a.jsx)(q,{onBack:()=>t(!1)}):s?(0,a.jsx)(U,{onBack:()=>m(!1)}):null:(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"container mx-auto px-4 py-16",children:[(0,a.jsxs)("div",{className:"text-center mb-16",children:[(0,a.jsx)(i.E.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"mb-8",children:(0,a.jsx)("img",{src:"/icone.png",alt:"IconeSign Logo",className:"h-24 w-auto mx-auto mb-4"})}),(0,a.jsxs)(i.E.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.3,type:"spring",stiffness:200},className:"inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm rounded-full px-6 py-3 mb-8 border border-white/30",children:[(0,a.jsx)(c.Z,{className:"w-5 h-5 text-adorable-pink animate-pulse"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Plateforme de Signature \xc9lectronique"})]}),(0,a.jsx)(i.E.h1,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.4},className:"text-6xl md:text-7xl font-display font-bold mb-6 bg-gradient-to-r from-adorable-pink via-adorable-purple to-adorable-blue bg-clip-text text-transparent",children:"IconeSign ✨"}),(0,a.jsxs)(i.E.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"text-xl md:text-2xl text-gray-600 mb-12 max-w-3xl mx-auto leading-relaxed",children:["Transformez vos factures avec notre plateforme \xe9l\xe9gante qui g\xe8re la",(0,a.jsx)("span",{className:"text-adorable-pink font-semibold",children:" signature"}),", la",(0,a.jsx)("span",{className:"text-adorable-purple font-semibold",children:" validation"})," et le",(0,a.jsx)("span",{className:"text-adorable-blue font-semibold",children:" traitement"})," en toute beaut\xe9"]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,a.jsxs)(i.E.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.8,type:"spring",stiffness:200},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>t(!0),className:"adorable-button text-white font-semibold px-12 py-4 rounded-2xl text-lg inline-flex items-center gap-3 animate-glow",children:[(0,a.jsx)(o.Z,{className:"w-6 h-6"}),"Commencer le Traitement",(0,a.jsx)(c.Z,{className:"w-6 h-6"})]}),(0,a.jsxs)(i.E.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.9,type:"spring",stiffness:200},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>m(!0),className:"px-12 py-4 border-2 border-adorable-blue text-adorable-blue rounded-2xl text-lg font-semibold hover:bg-adorable-blue hover:text-white transition-all duration-300 inline-flex items-center gap-3",children:[(0,a.jsx)(d.Z,{className:"w-6 h-6"}),"Consulter TTN"]})]})]}),(0,a.jsx)(i.E.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{delay:1},className:"grid md:grid-cols-2 lg:grid-cols-4 gap-8 mb-16",children:x.map((e,t)=>(0,a.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.2+.1*t},children:(0,a.jsx)(V,{...e})},t))}),(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{delay:1.4},className:"adorable-card p-8 max-w-4xl mx-auto",children:[(0,a.jsx)("h2",{className:"text-3xl font-display font-bold text-center mb-8 text-gray-800",children:"Comment \xe7a Fonctionne \uD83C\uDFAF"}),(0,a.jsx)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[{step:"1",title:"T\xe9l\xe9charger",emoji:"\uD83D\uDCC1",color:"bg-blue-500"},{step:"2",title:"Signer",emoji:"✍️",color:"bg-green-500"},{step:"3",title:"Valider",emoji:"✅",color:"bg-purple-500"},{step:"4",title:"Transformer",emoji:"\uD83D\uDD04",color:"bg-orange-500"},{step:"5",title:"T\xe9l\xe9charger",emoji:"\uD83D\uDCE6",color:"bg-pink-500"}].map((e,t)=>(0,a.jsxs)(i.E.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:1.6+.1*t,type:"spring"},className:"flex flex-col items-center gap-2",children:[(0,a.jsx)("div",{className:"w-16 h-16 ".concat(e.color," rounded-full flex items-center justify-center text-white font-bold text-xl shadow-lg"),children:e.step}),(0,a.jsx)("div",{className:"text-2xl",children:e.emoji}),(0,a.jsx)("div",{className:"font-semibold text-gray-700",children:e.title}),t<4&&(0,a.jsx)("div",{className:"hidden md:block absolute top-8 left-full w-8 h-0.5 bg-gray-300 transform translate-x-4"})]},t))})]})]})})]})}},7593:function(e,t,s){"use strict";s.d(t,{t:function(){return i}});var a=s(4660),r=s(4810);let i=(0,a.Ue)()((0,r.tJ)((e,t)=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null,signIn:async(t,s)=>{e({isLoading:!0,error:null});try{let a=await fetch("".concat("https://itchy-cars-march.loca.lt/api/v1","/auth/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usernameOrEmail:t,password:s})}),r=await a.json();if(!a.ok)throw Error(r.message||"Erreur de connexion");if(r.success&&r.data){let{token:t,...s}=r.data;e({user:s,token:t,isAuthenticated:!0,isLoading:!1,error:null}),localStorage.setItem("auth_token",t)}else throw Error(r.message||"R\xe9ponse invalide du serveur")}catch(t){throw console.error("Sign in error:",t),e({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:t instanceof Error?t.message:"Erreur de connexion inconnue"}),t}},signOut:()=>{localStorage.removeItem("auth_token"),e({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null})},clearError:()=>{e({error:null})},checkAuth:async()=>{let t=localStorage.getItem("auth_token");if(!t){e({isAuthenticated:!1,user:null,token:null});return}e({isLoading:!0});try{let s=await fetch("".concat("https://itchy-cars-march.loca.lt/api/v1","/auth/me"),{headers:{Authorization:"Bearer ".concat(t)}});if(!s.ok)throw Error("Token invalide");let a=await s.json();if(a.success&&a.data)e({user:a.data,token:t,isAuthenticated:!0,isLoading:!1,error:null});else throw Error("Donn\xe9es utilisateur invalides")}catch(t){console.error("Auth check error:",t),localStorage.removeItem("auth_token"),e({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null})}}}),{name:"auth-storage",partialize:e=>({user:e.user,token:e.token,isAuthenticated:e.isAuthenticated})}))}},function(e){e.O(0,[216,183,971,938,744],function(){return e(e.s=5629)}),_N_E=e.O()}]);